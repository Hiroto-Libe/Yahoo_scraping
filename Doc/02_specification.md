# 仕様検討書（Yahooショッピング 商品検索・価格監視）

## 1. 目的と前提
- 目的: YahooショッピングのItemSearch APIを利用し、価格監視と商品一覧収集を行う
- 実行: 手動実行
- 出力: CSV
- 件数上限: 50件/回

## 2. 全体構成
### 2.1 構成要素
- フロント: HTML/CSS（カテゴリ選択、キーワード入力、実行ボタン）
- バックエンド: Python（API呼び出し、CSV生成、ログ出力）
- 実行環境: ローカルサーバ

### 2.2 処理フロー
1. ユーザーがカテゴリとキーワードを入力
2. PythonがYahoo Shopping APIにリクエスト
3. レスポンスを整形しCSVを生成
4. CSVをダウンロードまたは所定パスに保存
5. 実行ログを出力

## 3. 入力仕様
### 3.1 カテゴリ
- 入力形式: セレクトボックス
- 値: Yahoo ShoppingカテゴリID
- 表示: カテゴリ名

### 3.2 キーワード
- 入力形式: テキストボックス
- 最大文字数: 未定（暫定: 100文字）
- 空入力: 不可

## 4. API仕様
### 4.1 利用API
- Yahoo Shopping API ItemSearch
- 参照: https://developer.yahoo.co.jp/webapi/shopping/v3/itemsearch.html

### 4.2 リクエストパラメータ（想定）
- appid: アプリケーションID
- query: キーワード
- category_id: カテゴリID
- results: 取得件数（最大50）
- start: 開始位置（任意、ページング用）
- sort: 並び順（任意、価格監視用途で検討）

### 4.3 レスポンス
- JSON
- 取得項目はCSV出力項目にマッピング

## 5. CSV出力仕様（暫定）
### 5.1 出力列
- 取得日時
- 商品名
- 価格
- 商品URL
- ショップ名
- 画像URL
- 在庫状況
- レビュー件数
- レビュー平均

### 5.2 ファイル名
- 形式: `yyyymmdd_hhmmss_itemsearch.csv`
- 保存先: `./output/`

## 6. エラー処理
### 6.1 リトライ
- API失敗時は最大2回リトライ
- リトライ間隔は固定（暫定: 2秒）

### 6.2 失敗時の扱い
- 3回失敗でエラー終了
- 失敗理由をログに記録

## 7. ログ仕様（暫定）
- 出力先: `./logs/`
- 形式: テキスト
- 記録内容:
  - 実行開始/終了
  - 入力パラメータ
  - APIリクエスト結果（成功/失敗）
  - 例外/エラーメッセージ

## 8. 画面仕様（暫定）
- 画面構成:
  - カテゴリ選択
  - キーワード入力
  - 実行ボタン
  - 結果メッセージ（成功/失敗）

## 9. 未確定事項
- カテゴリ一覧の取得方法（固定リスト or API取得）
- CSV出力列の最終確定
- エラー時の画面表示内容
